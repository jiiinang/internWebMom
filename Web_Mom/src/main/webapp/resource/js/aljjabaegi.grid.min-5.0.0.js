"use strict";!function(){var e=function(){this.prefix="",this.checkSize=40,this.scrollSize=17,this.browser="cr",this.cssClass={title:"ag_title",table:"ag_table",tableScroll:"ag_table_scroll",header:"ag_header",headerTable:"ag_grid_header",headerTableTr:"ag_grid_header_tr",headerTableTh:"ag_header_th",headerTableThEnd:"ag_header_th_end",headerTableThSpan:"ag_grid_header_th_span",headerTableThChk:"ag_header_chk",headerTableThChkDiv:"ag_header_th_chk_div",headerSearch:"ag_header_search",singleSearch:"ag_search",body:"ag_body",bodyTable:"ag_body_table",bodyTableNodata:"nodata",bodyTableTr:"ag_body_row",bodyTableTdChk:"ag_body_chk",bodyTableTdChkDiv:"ag_body_row_chk_div",footer:"ag_footer",footerTable:"ag_footer_table",footerTableTr:"ag_footer_row",page:"ag_pageBtn",pageInfo:"ag_paging",firstPage:"ag_f_page",beforePage:"ag_b_page",lastPage:"ag_l_page",nextPage:"ag_n_page",pageNumber:"ag_page_number",currentPage:"curr",recordCount:"ag_rc",recordCountSel:"ag_rc_sel",cudBtnEvent:"ag_btnArea",cBtnEvent:"ag_btn_regist",uBtnEvent:"ag_btn_update",dBtnEvent:"ag_btn_delete",eBtnEvent:"ag_btn_excel",modalDiv:"ag_modal",modalTitle:"ag_modal_title",modalTable:"ag_tbl_view",modalBefore:"ag_before",modalAfter:"ag_after",modalBtnArea:"ag_btnArea",background:"ag_modal_bg"},this.postData={pageIndex:1,countPerPage:10,totalPage:0,firstPageOnPageList:0,lastPageOnPageList:0,recordCountPerPage:10},this.customPostData={},this.basePostDataNm=["pageIndex","countPerPage","totalPage","firstPageOnPageList","lastPageOnPageList","recordCountPerPage"],this.modalInfo={afterProcess:!1,currentIndex:0,checkedData:[],updateData:[]},this.columnSort={},this.columnGroup=[],this.sortColumn=[],this.colM=[],this.colN=[],this.cud={},this.summary=[],this.displayRows=10,this.rows=[10,20,30,40,50,100],this.id="",this.div="",this.key="",this.title="",this.url="",this.searchType="",this.height="",this.autoSearch=!0,this.sort=!1,this.page=!0,this.multiSelection=!1,this.onClickRow=null,this.useFile=!1,this.reorder=!1,this.totalCnt=!0,this.files=[],this.dragTd,this.draggedDiv,this.colGroupIdx=[],this.colGroupRowIdx=[]};window.AG=function(t){var i=new e;if(i.browser=i.getBrowser(),i.undefinedCheck(t.id)?alert("그리드를 추가할 요소 id 옵션이 존재하지 않습니다."):(i.id=t.id,i.prefix="ag_"+t.id),i.undefinedCheck(t.url))return alert("조회에 필요한 url 옵션이 존재하지 않습니다."),!1;if(i.url=t.url,i.div=document.getElementById(t.id),i.key=t.key,"object"==typeof t.postData||!i.undefinedCheck(t.postData)){var s=Object.keys(t.postData);for(var a in i.customPostData=t.postData,s)i.postData[s[a]]=t.postData[s[a]],i.basePostDataNm.push(s[a])}return i.undefinedCheck(t.colM)||(i.colM=t.colM),i.undefinedCheck(t.colN)||(i.colN=t.colN),i.undefinedCheck(t.displayRows)||(i.displayRows=t.displayRows),i.undefinedCheck(t.rows)||(i.rows=t.rows),i.undefinedCheck(t.sort)||(i.sort=t.sort),i.undefinedCheck(t.reorder)||(i.reorder=t.reorder),i.undefinedCheck(t.totalCnt)||(i.totalCnt=t.totalCnt),i.undefinedCheck(t.title)||(i.title=t.title),i.undefinedCheck(t.height)||(i.height=t.height),i.undefinedCheck(t.autoSearch)||(i.autoSearch=t.autoSearch),i.undefinedCheck(t.page)||(i.page=t.page),i.undefinedCheck(t.searchType)||(i.searchType=t.searchType),i.undefinedCheck(t.multiSelection)||(i.multiSelection=t.multiSelection),i.undefinedCheck(t.cud)||(i.cud=t.cud),i.undefinedCheck(t.summary)||(i.summary=t.summary),i.undefinedCheck(t.onClickRow)||(i.onClickRow=t.onClickRow),i.undefinedCheck(t.columnGroup)||(i.columnGroup=t.columnGroup),i.undefinedCheck(t.loadComplete)||(i.loadComplete=t.loadComplete),i.autoHidden(),i.setTable(),i},e.prototype={setTable:function(){var e=this.createElementWithClass("div",this.cssClass.tableScroll);e.id=this.prefix+"_scroll";var t=this.createElementWithClass("div",this.cssClass.table);t.id=this.prefix,this.div.appendChild(e),e.appendChild(t),this.table=t,this.setHeader(),this.setBody(),this.setDefaultPage(),this.isEmpty(this.cud)||this.setCud(),this.setTableSize(),this.setHeight(),window.addEventListener("resize",this.setTableSize.bind(this)),this.autoSearch&&this.setAutoSearch()},setHeight:function(){var e=document.getElementById(this.prefix+"_body"),t=0;if(""!=this.height)t=this.height;else{var i=window.getComputedStyle(e).fontSize;t=(this.getOnlyNumber(i)+19)*this.displayRows}"cr"!=this.browser&&(t+=1),e.style.height=t+"px"},setTableSize:function(){for(var e=document.getElementsByTagName("colgroup"),t=e[0].children,i=(e[1].children,0),s=0;s<t.length;s++)null!=t[s].getAttribute("width")&&(i+=this.getOnlyNumber(t[s].getAttribute("width")));this.multiSelection&&(i+=40),this.div.clientWidth>0&&this.div.clientWidth<i&&(this.table.style.width=i+"px")},autoHidden:function(){var e=this;this.colM.forEach(function(t){e.undefinedCheck(t.type)||"textarea"!==t.type&&"file"!==t.type||(t.hidden=!0)})},getOnlyNumber:function(e){return e=e.replace(/[^(0-9)]/gi,""),Number(e)},setHeader:function(){var e="";(this.undefinedCheck(this.title)||this.div.insertAdjacentHTML("afterbegin","<div class='"+this.cssClass.title+"'><span>"+this.title+"</span></div>"),e+="<div id='"+this.prefix+"_header' class='"+this.cssClass.header+"'>",e+="<table id='"+this.prefix+"_header_table' class='"+this.cssClass.headerTable+"'>",this.columnGroup.length>0)&&(e+="<tr id='"+(this.prefix+"_header_tr_group")+"' class='"+this.cssClass.headerTableTr+"'></tr>");e+="<tr id='"+(this.prefix+"_header_tr")+"' class='"+this.cssClass.headerTableTr+"'></tr>",e+="</table></div>",this.table.insertAdjacentHTML("beforeend",e),this.columnGroup.length>0?this.setColumnGroup():this.setColumn(),this.sort&&this.setSortEvent(),"multi"==this.searchType&&this.setMultiSearchArea(),"single"==this.searchType&&this.setSingleSearchArea(),this.multiSelection&&this.setOnClickCheck(),this.setRecordCount(),this.reorder&&this.setDragHeader()},setDragHeader:function(){var e,t,i=this;this.columnGroup.length>0?(this.setColGroupIdx(),t=(e=document.getElementById(i.prefix+"_header_tr_group").children).length):t=(e=document.getElementById(i.prefix+"_header_tr").children).length;var s=function(e,t){-1===e.className.indexOf(t)&&(e.className+=" "+t)},a=function(e,t){e.className=e.className.replace(" "+t,"")},n=function(e){var t=document.getElementById(i.prefix+"ag_draggedDiv");null!==t&&t.parentNode.removeChild(t),i.dragTd=this,s(this,"ag_dragging"),i.draggedDiv=document.createElement("div"),i.draggedDiv.id=i.prefix+"ag_draggedDiv",i.draggedDiv.className="ag_draggedDiv",i.draggedDiv.style.width=this.clientWidth+"px",i.draggedDiv.style.top=e.pageY+5+"px",i.draggedDiv.style.left=e.pageX+10+"px",document.body.appendChild(i.draggedDiv);var a=document.createElement("table");a.className="ag_body_table",i.draggedDiv.appendChild(a);var n,o,l,d,r=i.dragTd.cellIndex,c=document.getElementById(i.prefix+"_body_table").rows;if(i.columnGroup.length>0)for(var h=0;h<c.length;h++){var u=c[h].cloneNode(!1),p=document.getElementById(u.id),f=i.colGroupIdx[r],m=i.colGroupRowIdx[r],g=f.length,v=m.length;if(g>1?(n=f[0],o=f[0]+g,l=m[0],d=m[0]+v):(n=f[0],o=f[0]+1,l=m[0],d=m[0]+1),p.id==i.prefix+"_body_header_tr_group"){var b=c[h].cells[r].cloneNode(!0);u.appendChild(b),a.appendChild(u)}else if(p.id==i.prefix+"_body_header_tr")if(g>1)for(var y=n;y<o;y++){b=c[h].cells[y].cloneNode(!0);u.appendChild(b),a.appendChild(u)}else a.appendChild(u);else{a.appendChild(u);for(y=l;y<d;y++){b=c[h].cells[y].cloneNode(!0);u.appendChild(b)}}}else for(h=0;h<c.length;h++){u=c[h].cloneNode(!1),b=c[h].cells[r].cloneNode(!0);u.appendChild(b),a.appendChild(u)}e.preventDefault()},o=function(e){s(this,"ag_hovering"),e.preventDefault()},l=function(e){a(this,"ag_hovering"),e.preventDefault()},d=function(e){if(null!=i.draggedDiv){var t=i.dragTd.cellIndex,s=this.cellIndex,n=document.getElementById(i.prefix+"_body_table").rows,o=document.getElementById(i.prefix+"_header_tr"),l=o.children;if(i.columnGroup.length>0){var d,r,c,h,u=document.getElementById(i.prefix+"_header_tr_group"),p=u.children,f=i.colGroupIdx[t],m=i.colGroupIdx[s],g=f.length,v=m.length,b=i.colGroupRowIdx[t];d=f[0],c=b[0],r=function(){var e=0;if(t<s)if(v>1)e=m[m.length-1]+1;else for(var a=t;a<s;a++)e=i.colGroupIdx[a][i.colGroupIdx[a].length-1]+1;else if(g>1)e=m[0];else for(a=s;a>t;a--)e=i.colGroupIdx[a][0];return e}();var y=document.getElementById(i.prefix+"_header_table").children[0],_=document.getElementById(i.prefix+"_body_table").children[1],C=y.children,x=_.children;if(t<s){u.insertBefore(p[t],p[s+1]),h=i.colGroupRowIdx[s][i.colGroupRowIdx[s].length-1]+1;for(var M=0;M<g;M++)y.insertBefore(C[c],C[h]),_.insertBefore(x[c],x[h])}else{u.insertBefore(p[t],p[s]),h=i.colGroupRowIdx[s][0];for(M=0;M<g;M++)y.insertBefore(C[c+M],C[h+M]),_.insertBefore(x[c+M],x[h+M])}if(console.log(g),g>1)for(var E=0;E<g;E++)t<s?0!=r&&(console.log(r),o.insertBefore(l[d],l[r])):f.length>1&&o.insertBefore(l[d+E],l[r+E]);for(E=0;E<n.length;E++){var I=n[E].cells;if(n[E].id==i.prefix+"_body_header_tr_group")t<s?n[E].insertBefore(I[t],I[s+1]):n[E].insertBefore(I[t],I[s]);else if(n[E].id==i.prefix+"_body_header_tr")for(M=0;M<g;M++)t<s?0!=r&&n[E].insertBefore(I[d],I[r]):f.length>1&&0!=r&&n[E].insertBefore(I[d+M],I[r+M]);else if(t<s)for(M=0;M<g;M++)n[E].insertBefore(I[c],I[h]);else for(M=0;M<g;M++)n[E].insertBefore(I[c+M],I[h+M])}i.multiSelection&&(t-=1,s-=1);var T=i.columnGroup[t];i.columnGroup.splice(t,1),i.columnGroup.splice(s,0,T),i.setColGroupIdx()}else{t<s&&(s+=1);var k=o.children;if(o.insertBefore(k[t],k[s]),i.multiSearch){var B=document.getElementById(i.prefix+"_header_search"),D=B.children;B.insertBefore(D[t],D[s])}for(E=0;E<n.length;E++){I=n[E].cells;n[E].insertBefore(I[t],I[s])}var w,S,L=i.dragTd.children[0].id.split("_")[2],P=this.children[0].id.split("_")[2];i.colM.forEach(function(e,t){e.id==L&&(w=t),e.id==P&&(S=t)});T=i.colM[w];i.colM.splice(w,1),i.colM.splice(S,0,T),a(i.dragTd,"ag_dragging"),a(this,"ag_hovering")}e.preventDefault()}},r=0;for(r=this.multiSelection?1:0;r<t-1;r++)e[r].draggable=!0,e[r].ondragstart=n,e[r].onmouseover=o,e[r].onmouseout=l,e[r].onmouseup=d,e[r].className="ag_tableHeader";document.body.onmousemove=function(e){i.draggedDiv&&(i.draggedDiv.style.top=e.pageY+5+"px",i.draggedDiv.style.left=e.pageX+10+"px",e.preventDefault())},document.body.onmouseup=function(e){null!=i.draggedDiv&&(i.draggedDiv.parentNode.removeChild(i.draggedDiv),i.draggedDiv=null,a(i.dragTd,"ag_dragging"),i.dragTd=null,e.preventDefault())}},setColGroupIdx:function(){var e=this.columnGroup.length;this.colGroupIdx=[],this.colGroupRowIdx=[];for(var t=[],i=[],s=0,a=0,n=0;n<e;n++){t=[],i=[];var o=this.columnGroup[n].span;if(this.undefinedCheck(o)){if(0==n)s=0,a=this.multiSelection?1:0;else{for(var l=this.colGroupIdx.length-1;l>-1;l--)if(this.colGroupIdx[l].length>1){s=this.colGroupIdx[l][this.colGroupIdx[l].length-1]+1;break}for(l=this.colGroupRowIdx.length-1;l>-1;l--){a=this.colGroupRowIdx[l][this.colGroupRowIdx[l].length-1]+1;break}}t.push(s),i.push(a),this.colGroupIdx.push(t),this.colGroupRowIdx.push(i)}else{if(0==n)s=0,a=this.multiSelection?1:0;else{for(l=this.colGroupIdx.length-1;l>-1;l--)if(this.colGroupIdx[l].length>1){s=this.colGroupIdx[l][this.colGroupIdx[l].length-1]+1;break}a=this.colGroupRowIdx[n-1][this.colGroupRowIdx[n-1].length-1]+1}for(var d=s;d<s+o;d++)t.push(d);for(d=a;d<a+o;d++)i.push(d);this.colGroupRowIdx.push(i),this.colGroupIdx.push(t)}}this.multiSelection&&(this.colGroupIdx.unshift([0,0]),this.colGroupRowIdx.unshift([0,0]))},setColumn:function(){var e=document.getElementById(this.prefix+"_header_tr"),t=document.getElementById(this.prefix+"_header_table");t.insertAdjacentHTML("afterbegin","<colgroup></colgroup>");var i="";this.multiSelection&&(i="<td scope='col' class='"+this.cssClass.headerTableThChk+"'>",i+="<div class='"+this.cssClass.headerTableThChkDiv+"'><input type='checkbox' id='"+this.prefix+"_chkAll'><label for='"+this.prefix+"_chkAll'></div></td>",e.insertAdjacentHTML("beforeend",i),t.children[0].insertAdjacentHTML("beforeend","<col width='40px'/>")),i="";for(var s=0;s<this.colM.length;s++)if(!this.colM[s].hidden){i="<td scope='col' class='"+this.cssClass.headerTableTh+"' style='"+this.setStyle(this.colM[s],"header")+"'><div id='"+this.prefix+"_"+this.colM[s].id+"'>"+this.colN[s]+"</div></td>",e.insertAdjacentHTML("beforeend",i);var a="";this.undefinedCheck(this.colM[s].size)||(a="width='"+this.colM[s].size+"'"),t.children[0].insertAdjacentHTML("beforeend","<col "+a+"/>")}"wh"!=this.browser&&(t.children[0].insertAdjacentHTML("beforeend","<col width='"+this.scrollSize+"px'/>"),e.insertAdjacentHTML("beforeend","<td scope='col' class='"+this.cssClass.headerTableThEnd+"'></td>"))},setColumnGroup:function(){var e=document.getElementById(this.prefix+"_header_tr_group"),t=document.getElementById(this.prefix+"_header_tr"),i=document.getElementById(this.prefix+"_header");i.children[0].insertAdjacentHTML("afterbegin","<colgroup></colgroup>");var s=0,a=0,n="";this.multiSelection&&(n="<td scope='col' class='"+this.cssClass.headerTableThChk+"' rowspan=2><div class='"+this.cssClass.headerTableThChkDiv+"'><input type='checkbox' id='"+this.prefix+"_chkAll'><label for='"+this.prefix+"_chkAll'></div></td>",e.insertAdjacentHTML("beforeend",n),i.getElementsByTagName("colgroup")[0].insertAdjacentHTML("beforeend","<col width='40px'/>")),n="";for(var o=0;o<this.colM.length;o++)if(!this.colM[o].hidden){var l="";this.undefinedCheck(this.colM[o].size)||(l="width='"+this.colM[o].size+"'"),i.getElementsByTagName("colgroup")[0].insertAdjacentHTML("beforeend","<col "+l+"/>"),s++,this.undefinedCheck(this.columnGroup[a])||(this.undefinedCheck(this.columnGroup[a].span)?(n="<td scope='col' class='"+this.cssClass.headerTableTh+"' rowspan=2 style='"+this.setStyle(this.colM[o],"header")+"'><div id='"+this.prefix+"_"+this.colM[o].id+"'>"+this.colN[o]+"</div></td>",e.insertAdjacentHTML("beforeend",n),s=0,a++):(n="<td scope='col' class='"+this.cssClass.headerTableTh+"' style='"+this.setStyle(this.colM[o],"header")+"'><div id='"+this.prefix+"_"+this.colM[o].id+"'>"+this.colN[o]+"</div></td>",t.insertAdjacentHTML("beforeend",n),s==this.columnGroup[a].span&&(n="<td scope='colgroup' class='"+this.cssClass.headerTableThSpan+"' colspan="+this.columnGroup[a].span+">"+this.columnGroup[a].title+"</td>",e.insertAdjacentHTML("beforeend",n),s=0,a++)))}"wh"!=this.browser&&(i.getElementsByTagName("colgroup")[0].insertAdjacentHTML("beforeend","<col width='"+this.scrollSize+"px'/>"),e.insertAdjacentHTML("beforeend","<td scope='col' class='"+this.cssClass.headerTableThEnd+"' rowspan=2></td>"))},setSingleSearchArea:function(){this.setCustomType=!1;var e,t="<fieldset class='"+this.cssClass.singleSearch+"'>";t+="<select id='"+this.prefix+"_single_search_col'>";for(var i=0;i<this.colM.length;i++)e=!0,(this.colM[i].hidden||!1===this.colM[i].searchable)&&(e=!1),e&&(t+="<option value='"+this.colM[i].id+"' idx='"+i+"' type='"+this.colM[i].type+"'>"+this.colN[i]+"</option>");t+="<input type='text' id='"+this.prefix+"_single_search_value' autocomplete='off'>",t+="<input type='button' id='"+this.prefix+"_single_search_btn' value='조회' class='btn_search'></fieldset>",this.div.insertAdjacentHTML("afterbegin",t);var s=document.getElementById(this.prefix+"_single_search_value");this.addEventListener(s,"click",function(){this.value=""});var a=document.getElementById(this.prefix+"_single_search_btn"),n=(s=document.getElementById(this.prefix+"_single_search_value"),this);this.addEventListener(s,"keyup",function(){13==window.event.keyCode&&(n.setSingleSearchData(),n.reloadRows("search"))}),this.addEventListener(a,"click",function(){n.setSingleSearchData(),n.reloadRows("search")});for(i=0;i<this.colM.length;i++)"date"!=this.colM[i].type&&"datetime"!=this.colM[i].type&&"combo"!=this.colM[i].type&&"number"!=this.colM[i].type||(this.setCustomType=!0);this.setCustomType&&this.setCustomSearch()},setMultiSearchArea:function(){var e="";this.setCustomType=!1,e+="<tr id='"+this.prefix+"_header_search' class='"+this.cssClass.headerSearch+"'>",this.multiSelection&&(e+="<td scope='col'></td>");for(var t=0;t<this.colM.length;t++)this.colM[t].hidden||(this.colM[t].searchable||0==this.colM[t].searchable?e+="<td scope='col'></td>":(e+="<td scope='col' id='"+this.prefix+"_multiSearch_"+this.colM[t].id+"_td'><input type='text' autocomplete='off' id='"+this.prefix+"_multiSearch_"+this.colM[t].id+"' style='width:90%;'></input></td>","date"!=this.colM[t].type&&"datetime"!=this.colM[t].type&&"combo"!=this.colM[t].type||(this.setCustomType=!0)));"wh"!=this.browser&&(e+="<td scope='col'></td>"),e+="</th></tr>",document.getElementById(this.prefix+"_header_table").insertAdjacentHTML("beforeend",e),this.setCustomType&&this.setCustomSearch()},setBodyHeader:function(){document.getElementById(this.prefix+"_body_table");if(this.columnGroup.length>0){var e=document.getElementById(this.prefix+"_body_header_tr_group"),t=document.getElementById(this.prefix+"_body_header_tr"),i=0,s=0,a="";this.multiSelection&&(a="<td scope='col' class='"+this.cssClass.headerTableThChk+"' rowspan=2></td>",e.insertAdjacentHTML("beforeend",a)),a="";for(var n=0;n<this.colM.length;n++)if(!this.colM[n].hidden){this.undefinedCheck(this.colM[n].size)||"width='"+this.colM[n].size+"'",i++,this.undefinedCheck(this.columnGroup[s])||(this.undefinedCheck(this.columnGroup[s].span)?(a="<td scope='col' class='"+this.cssClass.headerTableTh+"' rowspan=2 style='"+this.setStyle(this.colM[n],"header")+"'>"+this.colN[n]+"</td>",e.insertAdjacentHTML("beforeend",a),i=0,s++):(a="<td scope='col' class='"+this.cssClass.headerTableTh+"' style='"+this.setStyle(this.colM[n],"header")+"'>"+this.colN[n]+"</td>",t.insertAdjacentHTML("beforeend",a),i==this.columnGroup[s].span&&(a="<td scope='colgroup' class='"+this.cssClass.headerTableThSpan+"' colspan="+this.columnGroup[s].span+">"+this.columnGroup[s].title+"</td>",e.insertAdjacentHTML("beforeend",a),i=0,s++)))}"wh"!=this.browser&&e.insertAdjacentHTML("beforeend","<td scope='col' class='"+this.cssClass.headerTableThEnd+"' rowspan=2></td>")}else{var o=document.getElementById(this.prefix+"_body_header_tr");a="";this.multiSelection&&(a="<td scope='col' class='"+this.cssClass.headerTableThChk+"'></td>",o.insertAdjacentHTML("beforeend",a)),a="";for(n=0;n<this.colM.length;n++)if(!this.colM[n].hidden){a="<td scope='col' class='"+this.cssClass.headerTableTh+"' style='"+this.setStyle(this.colM[n],"header")+"'>"+this.colN[n]+"</td>",o.insertAdjacentHTML("beforeend",a);this.undefinedCheck(this.colM[n].size)||"width='"+this.colM[n].size+"'"}"wh"!=this.browser&&o.insertAdjacentHTML("beforeend","<td scope='col' class='"+this.cssClass.headerTableThEnd+"'></td>")}},setBody:function(){var e="";e+="<div id='"+this.prefix+"_body' class='"+this.cssClass.body+" "+this.cssClass.bodyTableNodata+"'>",e+="<table summary='"+this.title+" 리스트' id='"+this.prefix+"_body_table' class='"+this.cssClass.bodyTable+"'>",e+="<caption>"+this.title+" 리스트</caption>",e+="</table></div>",this.table.insertAdjacentHTML("beforeend",e);var t=document.getElementById(this.prefix+"_body_table"),i=document.getElementById(this.prefix+"_header_table").children[0].cloneNode(!0);this.removeElement(i.lastElementChild),t.appendChild(i);var s="";this.columnGroup.length>0&&(s+="<tr id='"+(this.prefix+"_body_header_tr_group")+"' class='"+this.cssClass.headerTableTr+"'></tr>");s+="<tr id='"+(this.prefix+"_body_header_tr")+"' class='"+this.cssClass.headerTableTr+"'>",t.insertAdjacentHTML("beforeend","<thead>"+s+"</thead>"),this.setBodyHeader(),t.insertAdjacentHTML("beforeend","<tbody></tbody>"),t.insertAdjacentHTML("beforeend","<tfoot></tfoot>")},setFooter:function(e){var t="";t+="<div id='"+this.prefix+"_footer' class='"+this.cssClass.footer+"'>",t+="<table id='"+this.prefix+"_footer_table' class='"+this.cssClass.footerTable+"'>",t+="</table></div>",this.table.insertAdjacentHTML("beforeend",t);var i=document.getElementById(this.prefix+"_footer_table"),s=document.getElementById(this.prefix+"_header_table").children[0].cloneNode(!0);s.lastElementChild.style.width=this.scrollSize-1+"px",i.appendChild(s),i.insertAdjacentHTML("beforeend","<tbody></tbody>"),t="";for(var a=0;a<this.summary.colM.length;a++){t+="<tr class='"+this.cssClass.footerTableTr+"'>",this.multiSelection&&(t+="<td style='text-align:right;'>");for(var n=0;n<this.colM.length;n++)if(!this.colM[n].hidden){t+="<td style='text-align:right;'>";e:for(var o=0;o<this.summary.colM[a].length;o++)if(this.colM[n].id===this.summary.colM[a][o].id){this.undefinedCheck(this.summary.colM[a][o].text)||(t+=this.summary.colM[a][o].text),this.undefinedCheck(this.summary.colM[a][o].expression)||(t+=e[this.summary.colM[a][o].expression]);break e}t+="</td>"}t+="<td></td></tr>"}i.children[1].insertAdjacentHTML("beforeend",t),document.getElementById(this.prefix+"_body_table").querySelector("tfoot").insertAdjacentHTML("beforeend",t)},removeFooter:function(){var e=document.getElementById(this.prefix+"_footer");this.removeElement(e)},setDefaultPage:function(){var e="",t=document.getElementById(this.prefix+"_paging");null!==t?(this.removePage(),e+="<div id='"+this.prefix+"_paging' class='"+this.cssClass.pageInfo+"'>",e+="<span class='"+this.cssClass.firstPage+"'>처음</span><span class='"+this.cssClass.beforePage+"'>이전</span>",e+="<span class='"+this.cssClass.pageNumber+" "+this.cssClass.currentPage+"'>1</span>",e+="<span class='"+this.cssClass.nextPage+"'>다음</span><span class='"+this.cssClass.lastPage+"'>마지막</span>",e+="</div>",t.insertAdjacentHTML("beforeend",e)):(e+="<div id='"+this.prefix+"_pageBtn' class='"+this.cssClass.page+"'>",0!=this.page&&(e+="<div id='"+this.prefix+"_paging' class='"+this.cssClass.pageInfo+"'>",e+="<span class='"+this.cssClass.firstPage+"'>처음</span><span class='"+this.cssClass.beforePage+"'>이전</span>",e+="<span class='"+this.cssClass.pageNumber+" "+this.cssClass.currentPage+"'>1</span>",e+="<span class='"+this.cssClass.nextPage+"'>다음</span><span class='"+this.cssClass.lastPage+"'>마지막</span></div>"),e+="</div>",this.div.insertAdjacentHTML("beforeend",e))},setPage:function(){var e=document.getElementById(this.prefix+"_paging");e.children.length>0&&this.removePage();var t=this.createElementWithClass("span",this.cssClass.firstPage);t.textContent="처음",this.addEventListener(t,"click",this.movePage.bind(this,1)),e.appendChild(t);var i=this.createElementWithClass("span",this.cssClass.beforePage);i.textContent="이전",this.addEventListener(i,"click",this.movePage.bind(this,this.postData.pageIndex-1)),e.appendChild(i);for(var s=this.postData.firstPageOnPageList;s<=this.postData.lastPageOnPageList;s++){var a=this.createElementWithClass("span",this.cssClass.pageNumber);this.postData.pageIndex==s&&a.classList.add(this.cssClass.currentPage),this.addEventListener(a,"click",this.movePage.bind(this,s)),a.textContent=s,e.appendChild(a)}var n=this.createElementWithClass("span",this.cssClass.nextPage);n.textContent="다음",this.addEventListener(n,"click",this.movePage.bind(this,this.postData.pageIndex+1)),e.appendChild(n);var o=this.createElementWithClass("span",this.cssClass.lastPage);o.textContent="마지막",this.addEventListener(o,"click",this.movePage.bind(this,this.postData.totalPage)),e.appendChild(o)},removePage:function(){var e=document.getElementById(this.prefix+"_paging");this.removeChildElement(e)},movePage:function(e){this.multiSelection&&(document.getElementById(this.prefix+"_chkAll").checked=!1),e>0&&e<=this.postData.totalPage&&(this.postData.pageIndex=e),this.reloadRows("page")},reloadRows:function(e){"search"==e&&(this.postData.pageIndex=1),"multi"==this.searchType&&this.setMultiSearchData(),this.multiSelection&&(document.getElementById(this.prefix+"_chkAll").checked=!1),this.removeRows(),this.undefinedCheck(this.summary.colM)||this.removeFooter(),this.removePage(),this.getData()},setRecordCount:function(){var e="";if(this.totalCnt&&(e+="<div class='"+this.cssClass.recordCount+"'>(전체 : <span id='"+this.prefix+"_total_cnt'></span>)&emsp;"),Array.isArray(this.rows)){if(document.getElementsByClassName(this.cssClass.recordCount).length<1){e+="<select id='"+this.prefix+"_record_cnt' class='"+this.cssClass.recordCountSel+"'>";for(var t=0;t<this.rows.length;t++)e+="<option value="+this.rows[t]+" "+this.postData.recordCountPerPage+">"+this.rows[t]+"</option>";if(e+="</select></div>","single"==this.searchType)document.getElementsByClassName(this.cssClass.singleSearch)[0].insertAdjacentHTML("afterend",e);else"multi"==this.searchType?this.div.insertAdjacentHTML("afterbegin",e):this.div.insertAdjacentHTML("beforebegin",e);this.postData.recordCountPerPage=this.rows[0],this.setOnChangeRecordCount()}}else e+="</div>",this.div.insertAdjacentHTML("beforebegin",e)},setOnChangeRecordCount:function(){var e=this;this.addEventListener(document.getElementById(this.prefix+"_record_cnt"),"change",function(){this.multiSelection&&(document.getElementById(e.prefix+"_chkAll").checked=!1),e.postData.recordCountPerPage=this.options[this.selectedIndex].value,e.reloadRows("search")})},setCud:function(){var e="<div id='"+this.prefix+"_btnArea' class='"+this.cssClass.cudBtnEvent+"'>";this.undefinedCheck(this.cud.ins)||(e+="<button id='"+this.prefix+"_insBtn' class='"+this.cssClass.cBtnEvent+"'><span>추가</span></button>"),this.undefinedCheck(this.cud.udt)||(e+="<button id='"+this.prefix+"_udtBtn' class='"+this.cssClass.uBtnEvent+"'><span>수정</span></button>"),this.undefinedCheck(this.cud.del)||(e+="<button id='"+this.prefix+"_delBtn' class='"+this.cssClass.dBtnEvent+"'><span>삭제</span></button>"),this.undefinedCheck(this.cud.excel)||(e+="<button id='"+this.prefix+"_excelBtn' class='"+this.cssClass.eBtnEvent+"'><span>엑셀</span></button>"),document.getElementById(this.prefix+"_pageBtn").insertAdjacentHTML("beforeend",e),this.setCudBtnOnClick(),this.setModal()},setCudBtnOnClick:function(){var e,t,i=this;this.undefinedCheck(this.cud.ins)||(e=document.getElementById(this.prefix+"_insBtn"),t=this.cud.ins.func?this.cud.ins.func.bind(i):function(){i.showModal("","I")},this.addEventListener(e,"click",t)),this.undefinedCheck(this.cud.udt)||(e=document.getElementById(this.prefix+"_udtBtn"),t=this.cud.udt.func?this.cud.udt.func.bind(i):function(){var e=i.getCheckedRows();if(!(e.length>0))return i.alertMsg("수정하실 데이터를 선택해주세요.");i.modalInfo.checkedData=e,i.showModal(e[0],"U")},this.addEventListener(e,"click",t)),this.undefinedCheck(this.cud.del)||(e=document.getElementById(this.prefix+"_delBtn"),t=this.cud.del.func?this.cud.del.func.bind(i):function(){var e,t=0;if(!((t=i.key?(e=i.getCheckedRows(i.key)).delKey.length:(e=i.getCheckedRows()).length)>0))return i.alertMsg("삭제하실 데이터를 선택해주세요.");confirm(t+"개 데이터를 삭제하시겠습니까?")&&i.ajax(i.getUrl("del"),e,function(t){200==t.resultCode?(alert(e.length+"개 데이터 삭제에 성공하였습니다."),i.reloadRows("search")):i.undefinedCheck(t.resultMsg)?alert("데이터 삭제에 실패하였습니다."):alert(t.resultMsg)})},this.addEventListener(e,"click",t)),this.undefinedCheck(this.cud.excel)||(e=document.getElementById(this.prefix+"_excelBtn"),t=this.cud.excel.func?this.cud.excel.func.bind(i):function(){if(confirm("엑셀파일로 출력하시겠습니까?")){"single"===i.searchType?i.setSingleSearchData():"multi"===i.searchType&&i.setMultiSearchData(),i.postData.colN=i.colN.join(",");var e=[];for(var t in i.colM)e.push(i.colM[t].id);i.postData.colM=e.join(","),i.ajaxExcel(i.cud.excel.url,"",function(e){})}},this.addEventListener(e,"click",t))},createElementWithClass:function(e,t){var i=document.createElement(e);return i.className=t,i},createElementWithId:function(e,t){var i=document.createElement(e);return i.id=t,i},getModalTbl:function(){var e=document.querySelector("#"+this.prefix+"_modal");if(null!=e)return e},getModalElement:function(){return document.getElementById(this.prefix+"_modal")},setAttributes:function(){for(var e=this.colM.length,t=0;t<e;t++){var i=this.colM[t];if(!this.undefinedCheck(i.attributes)){var s=this.prefix+"_"+i.id+"_value";Object.keys(i.attributes).forEach(function(e){document.getElementById(s).setAttribute(e,i.attributes[e])})}}},setModal:function(){var e=[],t=!1,i=this.createElementWithClass("div",this.cssClass.background);i.id=this.prefix+"_modal_bg",i.style.display="none";var s=this.createElementWithClass("div",this.cssClass.modalDiv);s.id=this.prefix+"_modal";var a=this.createElementWithClass("div",this.cssClass.modalTitle),n=document.createElement("h1");n.id=s.id+"_title";var o=document.createElement("a");o.href="#",this.addEventListener(o,"click",this.closeModal.bind(this)),o.textContent="x",a.appendChild(n),a.appendChild(o),s.appendChild(a);var l=this.createElementWithClass("table",this.cssClass.modalTable);l.id=this.prefix+"_table_view";for(var d=0;d<this.colM.length;d++){var r=document.createElement("tr");this.colM[d].hidden&&(r.hidden=!0,"file"!=this.colM[d].type&&"textarea"!=this.colM[d].type||(r.hidden=!1));var c=document.createElement("th"),h=document.createTextNode(this.colN[d]);if(c.appendChild(h),this.colM[d].mandentory){var u=document.createElement("span");u.textContent=" *",c.appendChild(u)}r.appendChild(c);var p=document.createElement("td");p.setAttribute("scope","col"),r.appendChild(p);var f=this.prefix+"_"+this.colM[d].id+"_value",m="<input type='text' id='"+f+"' value='' style='width:80%'";"combo"==this.colM[d].type?this.setCombobox(p,this.colM[d].comboData,"modal",f):"date"==this.colM[d].type||"datetime"==this.colM[d].type?(p.insertAdjacentHTML("beforeend",m+">"),e.push({id:f,type:this.colM[d].type,range:this.colM[d].range})):"file"==this.colM[d].type?this.setFile(p,"modal",this.prefix+"_"+this.colM[d].id,this.colM[d].multiFile):"textarea"==this.colM[d].type?this.setTextarea(p,"modal",f):"number"==this.colM[d].type?this.setNumber(p,f):"email"==this.colM[d].type?this.setEmail(p,f):p.insertAdjacentHTML("beforeend",m+">"),l.appendChild(r),this.undefinedCheck(this.colM[d].attributes)||(t=!0)}m="<span id='"+this.prefix+"_modal_b' class='"+this.cssClass.modalBefore+"'>이전</span><span id='"+this.prefix+"_modal_n' class='"+this.cssClass.modalAfter+"'>다음</span>";s.insertAdjacentHTML("beforeend",m);var g=this.createElementWithClass("div",this.cssClass.modalBtnArea);m="<button id='"+this.prefix+"_modal_ins_btn' class='"+this.cssClass.cBtnEvent+"'>추가</button><button id='"+this.prefix+"_modal_udt_btn' class='"+this.cssClass.cBtnEvent+"'>수정</button>";if(g.insertAdjacentHTML("beforeend",m),s.appendChild(l),s.appendChild(g),i.appendChild(s),document.body.appendChild(i),this.useFile&&(this.undefinedCheck(AGF)?alert("파일 타입을 사용할 경우 aljjabaegi.grid.file.js 파일이 필요합니다."):AGF.init(document.getElementById(this.prefix+"_modal"))),e.length>0)for(d=0;d<e.length;d++)this.setDatePicker(e[d].id,e[d].type,!this.undefinedCheck(e[d].range)&&e[d].range);this.addModalEvent(),t&&this.setAttributes()},delFile:function(e){var t=e.parentElement;t.parentElement.removeChild(t)},mappingModalData:function(e,t){for(var i=this,s=0;s<this.colM.length;s++){var a=this.colM[s].id;if(e.hasOwnProperty(a)){var n=this.prefix+"_"+a+"_value";"email"==this.colM[s].type&&(n+="_email_id");var o=document.getElementById(n),l=e[a];if(1!=this.colM[s].hidden&&1==o.parentNode.parentNode.hidden&&(o.parentNode.parentNode.hidden=!1),"combo"==this.colM[s].type)e:for(var d=0;d<this.colM[s].comboData.length;d++)if(l==this.colM[s].comboData[d].cbValue){l=this.colM[s].comboData[d].cbKey;break e}if("file"==this.colM[s].type){if(!this.undefinedCheck(e[a])){var r=e[a];if((f=r.length)>0){r.forEach(function(e){var t=document.createElement("li"),s=document.createElement("span"),n=i.createElementWithClass("button","ag_grid_del");n.textContent="삭제",i.addEventListener(n,"click",function(){i.delFile(this)}),s.textContent=e.realFileNm,t.appendChild(s),t.appendChild(n),document.getElementById(i.prefix+"_"+a+"_list").appendChild(t)})}}}else if("email"==this.colM[s].type){var c=this.undefinedCheck(l.split("@")[0])?"":l.split("@")[0],h=this.undefinedCheck(l.split("@")[1])?"":l.split("@")[1];o.value=c;var u=o.nextElementSibling.nextElementSibling,p=u.children,f=p.length,m=!1;for(d=0;d<f;d++)if(p[d].value==h){m=!0;break}if(m)u.value=h;else{var g=u.parentElement;g.removeChild(u),g.insertAdjacentHTML("beforeend","<input type='text' id='"+a+"_email_company' style='width:40%' value='"+h+"'>")}}else o.value=l;"V"==t?o.disabled=!0:this.colM[s].editable||0!=this.colM[s].editable?o.disabled=!1:o.disabled=!0}else{null!=(o=document.getElementById(this.prefix+"_"+this.colM[s].id+"_value"))&&(o.parentNode.parentNode.hidden=!0)}}},showModal:function(e,t){if(document.getElementById(this.prefix+"_modal_bg").style.display="block","U"==t){document.getElementById(this.prefix+"_modal_title").textContent=this.title+" 수정",document.getElementById(this.prefix+"_modal_b").style.display="block",document.getElementById(this.prefix+"_modal_n").style.display="block",document.getElementById(this.prefix+"_modal_udt_btn").style.display="block",document.getElementById(this.prefix+"_modal_ins_btn").style.display="none";for(var i=0;i<this.colM.length;i++){null!=(s=document.getElementById(this.prefix+"_"+this.colM[i].id+"_value"))&&(s.parentNode.parentNode.hidden?this.colM[i].editable?s.parentNode.parentNode.hidden=!1:s.parentNode.parentNode.hidden=!0:this.colM[i].editable||this.undefinedCheck(this.colM[i].editable)?s.disabled=!1:s.disabled=!0)}this.mappingModalData(e)}else if("I"==t){document.getElementById(this.prefix+"_modal_title").textContent=this.title+" 추가",document.getElementById(this.prefix+"_modal_b").style.display="none",document.getElementById(this.prefix+"_modal_n").style.display="none",document.getElementById(this.prefix+"_modal_udt_btn").style.display="none",document.getElementById(this.prefix+"_modal_ins_btn").style.display="block";for(i=0;i<this.colM.length;i++){var s;null!=(s=document.getElementById(this.prefix+"_"+this.colM[i].id+"_value"))&&(s.parentNode.parentNode.hidden?this.colM[i].addable?s.parentNode.parentNode.hidden=!1:s.parentNode.parentNode.hidden=!0:this.colM[i].addable||this.undefinedCheck(this.colM[i].addable)?s.disabled=!1:s.disabled=!0)}}else"V"==t&&(this.mappingModalData(e,t),document.getElementById(this.prefix+"_modal_udt_btn").style.display="none",document.getElementById(this.prefix+"_modal_ins_btn").style.display="none",document.getElementById(this.prefix+"_modal_b").style.display="none",document.getElementById(this.prefix+"_modal_n").style.display="none")},addModalEvent:function(){var e,t=this,i=document.getElementById(this.prefix+"_modal_udt_btn");e=function(){return t.modalInfo.updateData=t.getModalData(),t.undefinedCheck(t.cud.udt.popBtnFunc)?t.modalInfo.updateData?void(t.useFile?AGF.submit(t.cud.udt.url,t.modalInfo.updateData,function(e){console.log(e)},"json"):t.ajax(t.getUrl("udt"),t.modalInfo.updateData,function(e){200==e.resultCode?(alert("데이터 수정에 성공하였습니다."),t.modalInfo.afterProcess=!0):t.undefinedCheck(e.resultMsg)?alert("데이터 수정에 실패하였습니다."):alert(e.resultMsg)},"json")):(alert("필수 값을 입력하세요"),!1):t.cud.udt.popBtnFunc(t.getUrl("udt"),t.modalInfo.updateData)},this.addEventListener(i,"click",e);var s=document.getElementById(this.prefix+"_modal_b");this.addEventListener(s,"click",function(){0!=t.modalInfo.currentIndex&&(t.modalInfo.updateData[t.modalInfo.currentIndex]=t.getModalData(),t.modalInfo.currentIndex-=1,t.mappingModalData(t.modalInfo.checkedData[t.modalInfo.currentIndex]),t.modalInfo.checkedData[t.modalInfo.currentIndex]=t.modalInfo.checkedData[t.modalInfo.currentIndex])});var a=document.getElementById(this.prefix+"_modal_n");this.addEventListener(a,"click",function(){t.modalInfo.currentIndex<t.getCheckedRows().length-1&&(t.modalInfo.updateData[t.modalInfo.currentIndex]=t.getModalData(),t.modalInfo.currentIndex+=1,t.mappingModalData(t.modalInfo.checkedData[t.modalInfo.currentIndex]),t.modalInfo.checkedData[t.modalInfo.currentIndex]=t.modalInfo.checkedData[t.modalInfo.currentIndex])});var n,o=document.getElementById(this.prefix+"_modal_ins_btn");n=function(){return t.undefinedCheck(t.cud.ins.popBtnFunc)?t.getModalData()?void(t.useFile?AGF.submit(t.cud.ins.url,t.getModalData(),function(e){console.log(e)},"json"):t.ajax(t.getUrl("ins"),t.getModalData(),function(e){200==e.resultCode?(alert("데이터 저장에 성공하였습니다."),t.modalInfo.afterProcess=!0,t.closeModal()):t.undefinedCheck(e.resultMsg)?alert("데이터 저장에 실패하였습니다."):alert(e.resultMsg)},"json")):(alert("* 필수값을 입력하세요."),!1):t.cud.ins.popBtnFunc(t.getUrl("ins"),t.getModalData())},this.addEventListener(o,"click",n)},getModalData:function(){for(var e=document.getElementById(this.prefix+"_table_view").children,t={},i=e.length,s=0;s<i;s++){var a=e[s].children[0].children[0],n=e[s].children[1].children[0],o=n.getAttribute("id").split("_")[2],l=n.tagName,d=n.type,r="";if("file"!==d){if("SELECT"==l)r=n.options[n.selectedIndex].value;else if("email"==d){var c=n.nextElementSibling.nextElementSibling;"INPUT"==c.tagName?r=n.value+"@"+c.value:"SELECT"==c.tagName&&(r=n.value+"@"+c.options[c.selectedIndex].value)}else r=n.value;if(!this.undefinedCheck(a)){if("email"==d&&("@"==r||""==r.split("@")[1]))return!1;if(""==r)return!1}t[o]=r}else{var h=document.getElementById(this.prefix+"_"+o+"_list").children.length;if(!this.undefinedCheck(a)&&h<1)return!1}}return this.appendCustomPostData(t),t},closeModal:function(){this.modalInfo.currentIndex=0,this.modalInfo.updateData=[],this.modalInfo.insertData={},document.getElementById(this.prefix+"_modal_bg").style.display="none";var e=document.querySelectorAll("#"+this.prefix+"_table_view td"),t=this;e.forEach(function(e){if("file"==e.children[0].type)t.removeChildElement(e.children[2]);else if("email"==e.children[0].type){var i=e.children[0].id;i=i.substr(0,i.lastIndexOf("_")-6),t.setEmail(e,i)}else e.children[0].value=""}),this.modalInfo.afterProcess&&this.reloadRows("search"),this.modalInfo.afterProcess=!1},removeElement:function(e){e&&e.parentElement.removeChild(e)},removeChildElement:function(e){if(e&&e.hasChildNodes())for(;e.hasChildNodes();)e.removeChild(e.firstElementChild)},setAutoSearch:function(){var e=this;if("multi"==this.searchType){function t(){13==window.event.keyCode&&e.reloadRows("search")}for(var i=0;i<this.colM.length;i++){this.colM[i].type||this.colM[i].hidden||0==this.colM[i].searchable||this.colM[i].searchable||this.addEventListener(document.getElementById(this.prefix+"_multiSearch_"+this.colM[i].id),"keydown",t)}}this.getData()},setSingleSearchData:function(){for(var e=0;e<this.colM.length;e++)this.postData[this.colM[e].id]="","date"!=this.colM[e].type&&"datetime"!=this.colM[e].type||(this.postData[this.colM[e].id+"St"]="",this.postData[this.colM[e].id+"Ed"]="");var t=document.getElementById(this.prefix+"_single_search_col"),i=t.options[t.selectedIndex].value,s=t.options[t.selectedIndex].getAttribute("type"),a="",n=this.prefix+"_single_search_value",o=/[\{\}\[\]\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"|\s]/gi;if("date"==s)a=document.getElementById(n).value.replace(o,""),this.postData[i+"St"]=a.substring(0,8)+"000000",this.postData[i+"Ed"]=a.substring(8,16)+"235959";else if("datetime"==s)a=document.getElementById(n).value.replace(o,""),this.postData[i+"St"]=a.substring(0,12)+"00",this.postData[i+"Ed"]=a.substring(12,24)+"59";else if("combo"==s){var l=document.getElementById(this.prefix+"_single_search_value");a=l.options[l.selectedIndex].value}else a=document.getElementById(n).value;this.postData[i]=a},setMultiSearchData:function(){for(var e="",t=this.prefix+"_multiSearch_",i=0;i<this.colM.length;i++)if(!this.colM[i].hidden&&!this.colM[i].searchable&&0!=this.colM[i].searchable){if(e=document.getElementById(t+this.colM[i].id).value,"date"==this.colM[i].type||"datetime"==this.colM[i].type)e=e.replace(/[^(0-9)]/gi,"");else if("combo"==this.colM[i].type){var s=document.getElementById(t+this.colM[i].id);e=s.options[s.selectedIndex].value}this.postData[this.colM[i].id]=e}},setCombobox:function(e,t,i,s){var a="",n=e.parentNode;if(n.removeChild(e),t.length>0){"modal"==i?a+="<select id='"+s+"' style='width:80%;'>":"single"==i?a+="<select id='"+s+"' style='width:300px;'>":"multi"==i&&(a+="<select id='"+s+"' style='width:90%;'>"),a+="modal"===i?"<option value=''></option>":"<option value=''>전체</option>";for(var o=0;o<t.length;o++){a+="<option value='"+t[o].cbKey+"'>"+t[o].cbValue+"</option>"}if(a+="</select>","multi"==i)n.insertAdjacentHTML("beforeend",a);else if("single"==i){document.getElementById(this.prefix+"_single_search_col").insertAdjacentHTML("afterend",a)}else"modal"==i&&n.insertAdjacentHTML("beforeend","<td scope='col'>"+a+"</td>")}},setTextarea:function(e,t,i){var s=e.parentNode;s.removeChild(e);var a="<td>";a+="<textarea id='"+i+"' cols='39' rows='10'></textarea>",a+="</td>",s.insertAdjacentHTML("beforeend",a)},setNumber:function(e,t,i){var s=e.parentNode;s.removeChild(e);var a=document.createElement("td");a.scope="col";var n=this.createElementWithId("input",t);n.type="number",n.style.width="80%",a.appendChild(n),s.appendChild(a)},setEmail:function(e,t){var i=e.parentNode;i.removeChild(e);var s=document.createElement("td");s.scope="col";var a=this.createElementWithId("input",t+"_email_id");a.type="email";var n=this.createElementWithId("select",t+"_email_company"),o=document.createElement("span");o.textContent="@";n.insertAdjacentHTML("beforeend","<option value=''>선택</option><option value='naver.com'>naver.com</option><option value='gmail.com'>gmail.com</option><option value='hanmail.net'>hanmail.net</option><option value='yahoo.com'>yahho.com</option><option value='nate.com'>nate.com</option><option value=''>직접입력</option>");this.addEventListener(n,"change",function(){if(""==this.options[this.selectedIndex].value){var e=this.parentElement;e.removeChild(this),e.insertAdjacentHTML("beforeend","<input type='text' id='"+t+"_email_company' style='width:40%'>"),e.lastChild.focus()}}),a.style.width="37%",n.style.width="40%",s.appendChild(a),s.appendChild(o),s.appendChild(n),i.appendChild(s)},setFile:function(e,t,i,s){this.useFile=!0;var a=e.parentNode;a.removeChild(e);var n="<td><input type='file' id='"+i+"_value' name='"+i+"' style='width:79%; display:none' "+(s?"multiple":"")+">";n+="<label for='"+i+"_value'>파일선택</label>",n+="<ul class='ag_grid_atch' id='"+i+"_list'>",n+="</ul></td>",a.insertAdjacentHTML("beforeend",n)},setCustomSearch:function(){var e="";if("multi"==this.searchType){e=this.prefix+"_multiSearch_";for(var t=0;t<this.colM.length;t++)if(!this.colM[t].hidden&&!this.colM[t].searchable&&0!=this.colM[t].searchable)if("date"==this.colM[t].type||"datetime"==this.colM[t].type)this.setDatePicker(e+this.colM[t].id,this.colM[t].type,!0),this.autoSearch&&this.setDatePickerMutation(document.getElementById(e+this.colM[t].id));else if("combo"==this.colM[t].type){this.setCombobox(document.getElementById(e+this.colM[t].id),this.colM[t].comboData,"multi",e+this.colM[t].id);var i=this,s=document.getElementById(e+this.colM[t].id,!0);this.addEventListener(s,"change",this.reloadRows.bind(this,"search"))}}else if("single"==this.searchType){e=this.prefix+"_single_search_value";var a=document.getElementById(this.prefix+"_single_search_col"),n="";for(t=0;t<this.colM.length;t++)if(!this.colM[t].hidden&&!this.colM[t].searchable&&0!=this.colM[t].searchable){n=this.colM[t];break}n.type&&("date"==n.type||"datetime"==n.type?this.setDatePicker(e,n.type,!0):"combo"==n.type&&this.setCombobox(document.getElementById(e),n.comboData,"single",e));i=this;this.addEventListener(a,"change",function(){this.options[this.selectedIndex].value;var e=this.options[this.selectedIndex].getAttribute("idx"),t=i.prefix+"_single_search_value",s=document.getElementById(t);if(i.undefinedCheck(s)||(s.value=""),i.datePicker&&i.datePicker.cleanup(),"date"==i.colM[e].type||"datetime"==i.colM[e].type){s.parentNode.removeChild(s);var n="<input type='text' id='"+t+"' autocomplete='off'>";a.insertAdjacentHTML("afterend",n),i.setDatePicker(t,i.colM[e].type,!0)}else"combo"==i.colM[e].type?(i.setCombobox(document.getElementById(t),i.colM[e].comboData,"single",t),i.addEventListener(document.getElementById(t),"change",function(){i.setSingleSearchData(),i.reloadRows("search")})):(null==s&&(s=document.getElementById("ag_grid_single_search_col").nextElementSibling),s.parentNode.removeChild(s),n="<input type='text' id='"+t+"' autocomplete='off'>",a.insertAdjacentHTML("afterend",n),i.addEventListener(document.getElementById(t),"keyup",function(){13==window.event.keyCode&&(i.setSingleSearchData(),i.reloadRows("search"))}))})}},setDatePicker:function(e,t,i){var s=this.undefinedCheck(window)?void 0:window.ADP;if(!s)return alert("date/datetime 타입의 경우 달력을 사용하려면 표준 datepicker.js 파일을 import 해야합니다."),!1;var a={id:e,allowPast:!0,months:2,rangePicker:i,type:t};this.datePicker=new s(a)},setDatePickerMutation:function(e){var t=document.querySelector("body"),i=this;if(this.autoSearch){new MutationObserver(function(e){e.forEach(function(e){e.target.value&&-1!=e.target.value.indexOf("-")&&i.reloadRows("search")})}).observe(t,{characterData:!0,childList:!0,subtree:!0})}},setOnClickCheck:function(){var e=this;this.addEventListener(document.getElementById(this.prefix+"_chkAll"),"click",function(){for(var t=!!this.checked,i=document.getElementById(e.prefix+"_body_table").getElementsByTagName("tbody")[0].children,s=0;s<i.length;s++)i[s].children[0].children[0].children[0].checked=t})},setOnClickRow:function(){for(var e=document.getElementById(this.prefix+"_body_table").getElementsByTagName("tbody")[0].children,t=this,i=this.multiSelection?1:0,s=0;s<e.length;s++){e[s].style.cursor="pointer";var a={};function n(e){t.onClickRow.call(this,e,this.getAttribute("id"),t.getIndex(this))}for(var o=0;o<this.colM.length;o++)a[this.colM[o].id]=e[s].children[o+i].textContent,this.addEventListener(e[s].children[o+i],"click",n.bind(e[s].children[o+i].parentElement,a))}},getData:function(){var e=this;this.ajax(this.url,"",function(t){t.totalCnt>0?(console.log("print data"),document.getElementById(e.prefix+"_body").classList.remove(e.cssClass.bodyTableNodata),e.postData.totalPage=t.totalPage,e.postData.firstPageOnPageList=t.firstPageOnPageList,e.postData.lastPageOnPageList=t.lastPageOnPageList,e.setData(t),e.undefinedCheck(e.summary.colM)||e.setFooter(t),0!=e.page&&e.setPage(),e.onClickRow&&e.setOnClickRow()):(console.log("nodata"),document.getElementById(e.prefix+"_body").classList.add(e.cssClass.bodyTableNodata),0!=e.page&&e.setDefaultPage()),e.loadComplete(t)})},setData:function(e){var t=e.rows,i=t.length;this.totalCnt&&(document.getElementById(this.prefix+"_total_cnt").textContent=e.totalCnt);for(var s="",a=0;a<i;a++){s+="<tr class='"+this.cssClass.bodyTableTr+"' id='"+this.prefix+"_row_"+a+"'>",this.multiSelection&&(s+="<td scope='row' class='"+this.cssClass.bodyTableTdChk+"'><div class='"+this.cssClass.bodyTableTdChkDiv+"' name='"+this.prefix+"_row_chk_div'><input type='checkbox' id='"+this.prefix+"_row_chk_"+a+"'><label for='"+this.prefix+"_row_chk_"+a+"'></div></td>");var n=Object.keys(t[a]);this.undefinedCheck(t[a].files)||this.files.push(t[a].files);for(var o=0;o<this.colM.length;o++)if(this.undefinedCheck(t[a][this.colM[o].id]))s+="<td scope='row' title='' style='"+this.setStyle(this.colM[o],"body")+"'></td>";else for(var l=0;l<n.length;l++)if(n[l]==this.colM[o].id){var d=t[a][n[l]],r="";r=this.colM[o].formatter?this.colM[o].formatter.call(this.colM[o],d,t[a]):d,s+="<td scope='row' title='"+d+"' style='"+this.setStyle(this.colM[o],"body")+"'>"+r+"</td>"}s+="</tr>"}document.getElementById(this.prefix+"_body_table").getElementsByTagName("tbody")[0].insertAdjacentHTML("beforeend",s)},removeRows:function(){var e=document.getElementById(this.prefix+"_body_table").getElementsByTagName("tbody")[0];this.removeChildElement(e),document.getElementById(this.prefix+"_body").classList.add("loading")},setStyle:function(e,t){var i="";return e.hidden&&(i+=e.hidden?"display:none;":""),"body"==t&&e.align&&(i+="text-align:"+e.align+";"),i},setSortEvent:function(){for(var e=document.getElementById(this.prefix+"_header_tr").children,t=this,i=0;i<e.length-1;i++)for(var s=0;s<this.colM.length;s++)if(this.colM[s].id==e[i].childNodes[0].id.split("_")[2]&&(this.undefinedCheck(this.colM[s].sortable)||!0===this.colM[s].sortable)){var a=e[i].children[0];function n(i){for(var s=t.getIndex(this),a=0;a<e.length-1;a++)e[a].children[0].classList.remove("desc","asc");t.sortColumn[s]?t.sortColumn[s]="desc"==t.sortColumn[s]?"asc":"desc":t.sortColumn[s]="desc",i.setAttribute("class",t.sortColumn[s]),t.postData.sortColumn=i.id.split("_")[2],t.postData.sortOrder=t.sortColumn[s],t.reloadRows("search")}a.style.cursor="pointer",this.addEventListener(e[i],"click",n.bind(a.parentNode,a))}},getUrl:function(e){return this.cud[e].url},getIndex:function(e,t){if(t)return Array.prototype.indexOf.call(document.querySelectorAll(t),e);var i=Array.prototype.slice.call(e.parentNode.children);return i=i.filter(function(t){return t.tagName==e.tagName}),Array.prototype.indexOf.call(i,e)},getCheckedRows:function(e){for(var t=document.getElementsByName(this.prefix+"_row_chk_div"),i=[],s=0;s<t.length;s++)if(t[s].children[0].checked){for(var a=t[s].parentElement.parentElement,n=this.multiSelection?1:0,o={},l=0;l<this.colM.length;l++)e?this.colM[l].id==e&&i.push(a.children[l+n].textContent):"file"===this.colM[l].type?this.undefinedCheck(this.files[s])?o[this.colM[l].id]="":o[this.colM[l].id]=this.files[s][this.colM[l].id]:(o[this.colM[l].id]=a.children[l+n].textContent,this.appendCustomPostData(o));e?this.postData.delKey=i:i.push(o)}return this.undefinedCheck(e)?i:this.postData},appendCustomPostData:function(e){var t=this;Object.keys(this.customPostData).forEach(function(i){e[i]=t.customPostData[i]})},resetPostData:function(){var e=this;Object.keys(this.postData).forEach(function(t){"ie"==e.getBrowser()?-1==e.basePostDataNm.indexOf(t)&&delete e.postData[t]:e.basePostDataNm.includes(t)||delete e.postData[t]})},getBrowser:function(){var e=navigator.userAgent.toLowerCase(),t="";return"Netscape"==navigator.appName&&-1!=navigator.userAgent.search("Trident")||-1!=e.indexOf("msie")?(t="ie",this.scrollSize=18):-1!=e.indexOf("edge")?t="ed":-1!=e.indexOf("whale")?t="wh":-1!=e.indexOf("chrome")?(t="cr",this.scrollSize=9):-1!=e.indexOf("safari")?t="sf":-1!=e.indexOf("firefox")?t="ff":-1!=e.indexOf("opera")&&(t="op"),t},addEventListener:function(e,t,i){e.addEventListener(t,i,!1)},undefinedCheck:function(e){return void 0===e},alertMsg:function(e){return alert(e),!1},loadComplete:function(e){},isEmpty:function(e){return 0===Object.keys(e).length},addZero:function(e){return(e+="")[1]?e:"0"+e[0]},getDateString:function(){var e=new Date;return e.getFullYear().toString()+this.addZero(e.getMonth()+1)+this.addZero(e.getDate())+this.addZero(e.getHours())+this.addZero(e.getMinutes())},ajaxExcel:function(e,t,i){const s=new XMLHttpRequest;t||""!=t||(t=this.postData),s.open("POST",e),s.responseType="blob",s.setRequestHeader("Content-type","application/json; charset=UTF-8;");var a=this;s.onload=function(e){if(200==this.status){var t=(a.title?a.title:"엑셀다운로드")+"_"+a.getDateString()+".xls",i=new Blob([this.response]);if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(i,t);else{var s=URL.createObjectURL(i),n=document.createElement("a");n.href=s,n.download=t,document.body.appendChild(n),n.click()}}},s.onreadystatechange=function(){var e=document.getElementById(a.prefix+"_body");200==this.status&&2==this.readyState?e.classList.add("loading"):200==this.status&&4==this.readyState?e.classList.remove("loading"):404==this.status&&4==this.readyState&&alert("요청하신 URL을 찾을 수 없습니다.")},s.send(JSON.stringify(t)),delete a.postData.colM,delete a.postData.colN},ajax:function(e,t,i){const s=new XMLHttpRequest;var a;t||""!=t||(t=this.postData),s.open("POST",e),s.responseType="json",s.setRequestHeader("Content-type","application/json; charset=UTF-8;");var n=this;s.onload=function(e){200==this.status&&(a="ie"==n.browser?JSON.parse(this.response):this.response,n.resetPostData(),i(a))},s.onreadystatechange=function(){var e=document.getElementById(n.prefix+"_body");200==this.status&&2==this.readyState?(console.log("loading..."),e.classList.add("loading")):200==this.status&&4==this.readyState?(console.log("end loading..."),e.classList.remove("loading")):404==this.status&&4==this.readyState&&alert("요청하신 URL을 찾을 수 없습니다.")},s.send(JSON.stringify(t))}}}();